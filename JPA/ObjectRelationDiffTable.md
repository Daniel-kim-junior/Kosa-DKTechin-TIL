# 객체와 테이블이 연관관계를 맺는 차이

*테이블은 외래키(Foriegn Key)로 관계를 맺는다
(양방향 연관관계 필드 한개 (외래키 값) 사실상 방향은 없음)


그렇다면 JPA에서 객체는 무엇으로 연관관계를 맺는가?
객체는 멤버 변수 2개로 서로 다른 단방향 연관관계를 두 번 구현 (참조) 하여 양방향 연관관계를 맺는다.
```
A -> B (a.getB()) 참조
B <- A (b.getA()) 참조
```

그렇다면  양방향 매핑에서 Update를 한다고 가정해보자
연관관계를 가진 모두를 전부 Update한다는 것은 굉장히 비효율적이고 설계상도 알맞지 않다

그렇다면 어떤 필드를 변경해야하는걸까 이것을 연관관계의 주인이라는 개념으로 쉽게 해결하자

---


## 연관관계의 주인

둘 중 하나를 외래키로 관리해야 하며 우리는 그 외래키를 가진 주인만을 변경하고
나머지 객체는 읽기전용으로 사용하는 것이 효율적이다.

- 주인은 mapped by 속성을 사용하지 않는다.
- N:1의 관계에서 N의 위치에 있는 객체 테이블이 외래키를 가지고 있고 그 객체가 연관관계의 주인이다.

	ex) 자동차와 바퀴와의 관계 - 1 : N의 규칙에 따라 바퀴가 연관관계의 주인 OneToMany
	   Team과 Member와의 관계 - 1 : N의 규칙에 따라 멤버가 연관관계의 주인 OneToMany

이런 식으로 객체와 DB를 매핑하자

## 연관관계 편의 메소드를 작성하자

- 기존의 Setter 관례에 따라 예기지 못한 버그가 발생할 수 있기 때문에(여러 사람이 개발하기 때문에)
  이름을 변경해서 코딩하자

- 연관관계 편의 메소드를 양방향에 다 설정하게 된다면 무한 루프 등 치명적인 버그를 일으킬 수 있기 때문에 주의하자 (한쪽에만 설정)


