<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <header style="text-align: center;">
    <h1>HTML5 API 실습</h1>
  </header>
  <main>
    <section id="btn-container" style="text-align: center; margin: 5rem;">
      <button value="save" style="margin: 10px">저장하기</button>
      <button value="remove" style="margin: 10px">삭제하기</button>
      <button value="read" style="margin: 10px">읽어오기</button>
    </section>
    <section style="text-align: center;">
      <canvas id="img-container" style="border: 1px solid black; height: 500px; width: 1000px;"></section>
    </section>
  </main>
</body>
  <script>
    const btns = document.querySelector("#btn-container");
    let canvas;
    let context;
    let rect;
    function start() {
      context.clearRect(0, 0, 1000, 500);
      context.beginPath();
      context.rect(0, 0, 1000, 500);
      context.fillStyle = "#00001a";
      context.fill();
      context.stroke();
    }


    function saveData() {
      if(!localStorage) {
        alert("로컬 스토리지를 지원하지 않는 브라우저입니다.");
      } else {
        localStorage.setItem("canvas", canvas.toDataURL());
      }
    }

    function readData() {
      if(!localStorage) {
        alert("로컬 스토리지를 지원하지 않는 브라우저입니다.");
      } else {
        let img = new Image();
        img.src = localStorage.canvas;
        img.onload = function() {
          context.drawImage(img, 0, 0);
        }
      }
    }

    function removeData() {
      if(!localStorage) {
        alert("로컬 스토리지를 지원하지 않는 브라우저입니다.");
      } else {
          
      }
    }

    function makePicture() {
      let elem = document.getElementById('img-container');
      canvas = elem.getContext('2d');
      canvas.fillStyle = '#f7d71c';
      canvas.lineWidth = 3;
      canvas.fillRect(0, 0, 580, 450);
      
      canvas.beginPath();
      canvas.strokeStyle = '#292b19';
      canvas.arc(210, 30, 20, 9, Math.PI*2.5, false);
      canvas.fillStyle = '#eea02e';
      canvas.fill();
      canvas.stroke();

      canvas.beginPath();
      canvas.arc(90, 30, 20, 20, Math.PI*2, false);
      canvas.fillStyle = '#eea02e';
      canvas.fill();
      canvas.stroke();

      canvas.beginPath();
      canvas.arc(150, 100, 90, 0, Math.PI*2, false);
      canvas.fillStyle = '#eea02e';
      canvas.fill();
      canvas.stroke();

      // 새로운 경로 시작
      canvas.beginPath();
      canvas.moveTo(90, 60);

      // 선의 끝점 지정
      canvas.lineTo(130, 60);
      // 선 그리기
      canvas.stroke();


      // 새로운 경로 시작
      canvas.beginPath();
      canvas.moveTo(165, 60);

      // 선의 끝점 지정
      canvas.lineTo(210, 60);
      // 선 그리기
      canvas.stroke();

      canvas.beginPath();
      canvas.arc(110, 80, 5, 0, Math.PI*2, false);
      canvas.fillStyle = '#000000';
      canvas.fill();
      canvas.stroke();
      

      canvas.beginPath();
      canvas.arc(185, 80, 5, 0, Math.PI*2, false);
      canvas.fillStyle = '#000000';
      canvas.fill();
      canvas.stroke();


      canvas.beginPath();
      canvas.arc(145, 103, 5, 0, Math.PI*2, false);
      canvas.fillStyle = '#000000';
      canvas.fill();
      canvas.stroke();


      canvas.beginPath();
      canvas.arc(130, 110, 12, 0, Math.PI*2, false);
      canvas.fillStyle = '#f7f7f7';
      canvas.stroke();

      canvas.beginPath();
      
      canvas.arc(160, 110, 12, 0, Math.PI*2, false);
      canvas.fillStyle = '#f7f7f7';
      canvas.fill();
      canvas.stroke();


      canvas.save();
    }

    
    
    btns.addEventListener('click', function(e) {
      if(e.target.value) {
        if(e.target.value == 'read') {
          readData();
        }
        if(e.target.value == 'remove') {
          removeData();
        }
        if(e.target.value == 'save') {
          saveData();
        }

      }
    })
    
    document.body.onload = function() {
      canvas = document.getElementById("img-container");
      context = canvas.getContext("2d");
      rect = canvas.getBoundingClientRect();
      start();
      makePicture();
    } 




  </script>
</html>